<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>ZengCP's BLOGS - 同学，走稳一点……</title><meta name="author" content="ZengCP"><meta name="copyright" content="ZengCP"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="记录心得，见证成长">
<meta property="og:type" content="website">
<meta property="og:title" content="ZengCP&#39;s BLOGS">
<meta property="og:url" content="http://example.com/page/3/index.html">
<meta property="og:site_name" content="ZengCP&#39;s BLOGS">
<meta property="og:description" content="记录心得，见证成长">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://my-blog-images-1314066800.cos.ap-guangzhou.myqcloud.com/images/dog.png">
<meta property="article:author" content="ZengCP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://my-blog-images-1314066800.cos.ap-guangzhou.myqcloud.com/images/dog.png"><link rel="shortcut icon" href="https://my-blog-images-1314066800.cos.ap-guangzhou.myqcloud.com/images/longmao.png"><link rel="canonical" href="http://example.com/page/3/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ZengCP\'s BLOGS',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2025-02-25 23:37:06'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://my-blog-images-1314066800.cos.ap-guangzhou.myqcloud.com/images/dog.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">73</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">37</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">31</div></a></div><hr class="custom-hr"/></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://my-blog-images-1314066800.cos.ap-guangzhou.myqcloud.com/images/longmao_wallpaper_1.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="ZengCP's BLOGS"><span class="site-name">ZengCP's BLOGS</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">ZengCP's BLOGS</h1></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/09/08/%E5%88%86%E5%B8%83%E5%BC%8F%20%E4%B8%8E%20%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/%E7%86%94%E6%96%AD%E3%80%81%E9%99%90%E6%B5%81%20%E4%B8%8E%20%E9%99%8D%E7%BA%A7/" title="熔断、降级、限流">熔断、降级、限流</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-09-08T13:47:59.000Z" title="发表于 2024-09-08 21:47:59">2024-09-08</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/">服务治理</a></span></div><div class="content">一、熔断（Circuit Breaker）1.1 熔断机制概述熔断机制是一种保护机制，类似于电路中的保险丝。当某个服务调用失败次数或响应时间超过预设阈值时，熔断器会自动“断开”，直接返回错误，避免故障进一步扩散。熔断器通常有三种状态：

关闭状态（Closed）：正常请求通过，未检测到故障。
打开状态（Open）：熔断器触发，所有请求立即失败。
半开状态（Half-Open）：部分请求尝试重新连接目标服务，验证其是否恢复。

1.2 熔断策略熔断策略通常包括以下几种：

失败率阈值：当服务调用失败率达到预设阈值时触发熔断。
慢调用比例：当服务响应时间超过预设阈值的比例过高时触发熔断。
超时时间：熔断后设置超时时间，等待服务恢复正常。

1.3 熔断实现与技术选型
Hystrix：Netflix 开源的熔断库，支持熔断、降级和限流功能。虽然已停止维护，但其在遗留系统中仍有广泛应用。
Resilience4j：轻量级的熔断库，专为响应式编程和 Java 8+ 设计，支持基于访问数量和时间的滑动窗口统计。
Sentinel：阿里巴巴开源的限流、熔断和降级组件，支持多种框架集成，功能丰富。

 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/09/08/%E5%88%86%E5%B8%83%E5%BC%8F%20%E4%B8%8E%20%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0/" title="服务治理注册与发现">服务治理注册与发现</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-09-08T08:37:19.000Z" title="发表于 2024-09-08 16:37:19">2024-09-08</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/">服务治理</a></span></div><div class="content">服务注册与发现一、概念在微服务架构中，服务实例的数量和位置可能会动态变化。例如，新的服务实例可能会随时启动，旧的服务实例可能会因为故障而停止。服务注册与发现机制的作用就是让服务能够动态地加入和离开系统，并且让其他服务能够快速找到并调用它们。
服务注册 ：服务提供者将自己的信息（如服务名称、IP 地址、端口号等）注册到一个中央注册中心的过程。
注册中心可以是一个数据库、一个专门的服务注册服务器，或者一个分布式存储系统。服务提供者在启动时会将自己的信息发送给注册中心，注册中心会存储这些信息以便其他服务能够查询。
服务发现 ：服务消费者通过注册中心（NameServer）查询服务提供者信息的过程。
当服务消费者需要调用某个服务时，它会向注册中心发送请求，注册中心会返回当前可用的服务提供者列表。服务消费者可以根据这些信息选择一个服务提供者进行调用。
二、服务注册与发现的实现方式1、客户端发现模式客户端发现模式是指服务消费者直接从注册中心获取服务实例列表，并根据负载均衡策略选择服务实例进行调用。
优点
灵活性高：客户端可以根据实时的服务状态和负载情况动态选择服务实例。
去中心化：每个客户端独立进 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/09/08/%E5%88%86%E5%B8%83%E5%BC%8F%20%E4%B8%8E%20%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86%E7%AE%80%E4%BB%8B/" title="服务治理概述">服务治理概述</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-09-08T06:53:38.000Z" title="发表于 2024-09-08 14:53:38">2024-09-08</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/">服务治理</a></span></div><div class="content">服务治理概述服务治理是微服务架构中的核心概念，旨在确保分布式系统中各个服务的稳定性、可靠性和可维护性。它涵盖了从服务发现到故障恢复的多个方面。以下是服务治理的主要方面：

1. 服务发现与注册
定义：服务实例启动时向注册中心注册自己的信息（如IP、端口、服务名），其他服务通过注册中心发现目标服务。
常见工具：
Consul：支持服务发现、健康检查、KV存储。
Eureka：Netflix开源的注册中心，适合Spring Cloud生态。
Zookeeper：分布式协调服务，支持服务注册与发现。
Nacos：阿里巴巴开源的注册中心，支持服务发现和配置管理。


关键点：
服务动态上下线。
服务信息的实时更新。




2. 负载均衡
定义：将请求均匀分发到多个服务实例，以提高系统的吞吐量和可用性。
负载均衡策略：
轮询（Round Robin）。
加权轮询（Weighted Round Robin）。
最小连接数（Least Connections）。
一致性哈希（Consistent Hashing）。


实现方式：
客户端负载均衡（如Ribbon）。
服务端负载均衡（如Nginx、 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/09/07/%E5%88%86%E5%B8%83%E5%BC%8F%20%E4%B8%8E%20%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" title="负载均衡概述">负载均衡概述</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-09-07T14:17:15.000Z" title="发表于 2024-09-07 22:17:15">2024-09-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/">服务治理</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/">负载均衡</a></span></div><div class="content">负载均衡常见面试题解析一、基础概念1. 什么是负载均衡？为什么需要它？答案：负载均衡是一种将网络请求或计算任务动态分配到多个服务器（或资源）的技术，目标是：

提高系统吞吐量：避免单个服务器过载。
增强可用性：通过故障转移（Failover）避免单点故障。
优化资源利用率：合理分配请求，减少资源浪费。

2. 四层负载均衡 vs. 七层负载均衡的区别？答案：  

四层（L4）：基于内核态的TCP&#x2F;IP协议栈，通过修改IP&#x2F;TCP头信息实现转发（如DNAT）。性能高（可达到百万级QPS），但无法理解HTTP报文。典型工具：LVS（Linux Virtual Server）。
七层（L7）：工作在用户态，解析HTTP&#x2F;HTTPS头部，支持按URL、Cookie等路由。性能较低（通常十万级QPS），但灵活性极强。典型工具：Nginx、Envoy。性能优化：LVS使用IPVS内核模块避免数据拷贝；Nginx通过epoll多路复用和非阻塞I&#x2F;O提升并发能力。关键区别：L7能识别应用协议，支持更复杂的路由策略（如按URL分发），但延迟略高。

3. 负载均 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/09/07/%E5%88%86%E5%B8%83%E5%BC%8F%20%E4%B8%8E%20%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/HaProxy%20%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97/" title="HaProxy 配置详解">HaProxy 配置详解</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-09-07T13:56:29.000Z" title="发表于 2024-09-07 21:56:29">2024-09-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/">服务治理</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/">负载均衡</a></span></div><div class="content">HAProxy 配置详解与综合示例一、配置文件结构解析HAProxy配置文件由5个主要部分组成，优先级从高到低：

global：全局系统参数
defaults：默认参数模板
frontend：客户端连接入口
backend：服务端集群配置
listen：frontend+backend组合声明

二、核心配置指令详解2.1 全局配置（Global）123456789global    log 127.0.0.1 local0 info    # 日志服务器配置    maxconn 100000               # 最大并发连接数    user haproxy                 # 运行用户    group haproxy                # 运行组    nbthread 4                   # 工作线程数（建议等于CPU核心）    stats socket /var/run/haproxy.sock mode 660 level admin # 管理接口    ssl-default-bind-ciphers EC ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/09/07/%E5%88%86%E5%B8%83%E5%BC%8F%20%E4%B8%8E%20%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/HaProxy%20%E8%AF%A6%E8%A7%A3/" title="HaProxy 概述">HaProxy 概述</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-09-07T12:43:47.000Z" title="发表于 2024-09-07 20:43:47">2024-09-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/">服务治理</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/">负载均衡</a></span></div><div class="content">HAProxy深度指南：从配置实战到架构选型一、核心概念解析1.1 四层 vs 七层代理HAProxy同时支持L4(TCP)和L7(HTTP)代理，架构差异如下：



特性
L4代理
L7代理



协议感知
无
有（HTTP解析）


会话保持
基于源IP
基于Cookie&#x2F;Header


健康检查
TCP端口检测
HTTP状态码验证


典型场景
数据库负载均衡
Web应用路由


1.2 核心组件123456789101112131415frontend web-in           # 流量入口    bind *:80    acl is_api path_beg /api    use_backend api_cluster if is_api    default_backend web_serversbackend web_servers       # 服务集群    balance roundrobin    server web1 10.0.1.1:80 check    server web2 10.0.1.2:80 checklisten s ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/09/07/%E5%88%86%E5%B8%83%E5%BC%8F%20%E4%B8%8E%20%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/K8S%20%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E4%B8%8E%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E8%A7%A3%E6%9E%90/" title="K8S 服务注册、发现 与 负载均衡 原理解析">K8S 服务注册、发现 与 负载均衡 原理解析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-09-07T05:57:48.000Z" title="发表于 2024-09-07 13:57:48">2024-09-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/">云原生</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/">服务治理</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/K8S/">K8S</a></span></div><div class="content">K8S 服务注册、发现 与 负载均衡 原理解析在 Kubernetes（K8S）集群中，服务注册、发现与负载均衡是确保微服务架构高效运行的核心机制。这些机制共同解决了分布式系统中服务实例动态变化、流量分配以及高可用性等问题。本文将系统、专业地解析这些机制的原理，并提供详细的配置示例，帮助读者深入理解 K8S 的工作方式。
一、服务注册原理1.1 服务注册的概念服务注册是指将服务实例的相关信息（如 IP 地址、端口号等）记录到一个中心化的注册中心，以便其他服务能够发现并调用这些服务。在 K8S 中，服务注册主要通过 API Server 和 etcd 来实现。
1.2 服务注册的流程
Pod 创建时注册：当一个新的 Pod 创建时，Kubelet 会将该 Pod 的信息（包括 IP 地址、端口号等）注册到 API Server。
API Server 存储信息：API Server 接收到 Pod 信息后，将其存储到 etcd 中。
Service 关联 Pod：Service 通过标签选择器（Label Selector）与 Pod 进行关联。当 Service 创建时，API Ser ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/09/06/%E5%88%86%E5%B8%83%E5%BC%8F%20%E4%B8%8E%20%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/NGINX%20%E8%BF%9B%E9%98%B6/" title="NGINX 进阶">NGINX 进阶</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-09-06T15:17:41.000Z" title="发表于 2024-09-06 23:17:41">2024-09-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/">服务治理</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/">负载均衡</a></span></div><div class="content">NGINX 进阶一、NGINX架构设计核心1.1 多进程模型NGINX采用经典的主从多进程架构，包含1个Master进程和N个Worker进程（N通常等于CPU核心数），其中：

Master 进程主要用来管理 Worker 进程，包含：

接收来自外界的信号，向各 Worker 进程发送信号，
监控 Worker 进程的运行状态，当 Worker 进程异常退出后，会自动重新启动新的 Worker 进程。


Worker 进程则负责处理基本的网络事件。

多个 Worker 进程之间是对等的，他们同等竞争来自客户端的请求，各进程互相之间是独立的。
一个请求，只可能在一个 Worker 进程中处理，一个 Worker 进程，不可能处理其它进程的请求。



这种设计实现了：

热部署与零停机更新：通过execve()系统调用原子替换二进制文件
异常隔离机制：Worker进程崩溃不会影响整体服务
特权分离设计：Master进程以root身份运行，Worker以降权身份执行

Nginx 的进程模型，可以由下图来表示：


1.1.1 热升级技术实现零宕机升级流程：

旧Master收到U ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/09/06/%E5%88%86%E5%B8%83%E5%BC%8F%20%E4%B8%8E%20%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/NGINX%20%E7%AE%80%E4%BB%8B/" title="NGINX 概述">NGINX 概述</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-09-06T13:37:09.000Z" title="发表于 2024-09-06 21:37:09">2024-09-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/">服务治理</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/">负载均衡</a></span></div><div class="content">NGINX 简介Nginx是一款高性能的开源HTTP服务器和反向代理服务器，同时也支持IMAP&#x2F;POP3代理服务器。它以其高性能、稳定性、丰富的功能和低资源消耗而闻名。以下是Nginx的一些基础知识，包括其架构、配置文件、主要模块和常见用途。
1. Nginx 架构1.1 工作原理Nginx采用事件驱动的非阻塞I&#x2F;O模型，能够高效地处理大量并发连接。其架构主要包括以下几个部分：

主进程（Master Process）：负责管理和维护工作进程，处理日志文件的写入等。
工作进程（Worker Processes）：实际处理客户端请求，每个工作进程可以处理多个连接。
缓存管理：Nginx可以缓存静态文件和动态内容，提高响应速度。

1.2 事件驱动模型Nginx 使用事件驱动模型来处理请求，这意味着它可以同时处理多个连接，而无需为每个连接创建一个线程或进程。这种模型使得Nginx在处理高并发请求时表现出色。
2. 配置文件2.1 配置文件结构Nginx的配置文件通常位于/etc/nginx/nginx.conf，或者在/etc/nginx/sites-available ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/07/21/%E6%A1%86%E6%9E%B6/Netty/Netty%20%E5%9F%BA%E7%A1%80/Pipeline/" title="Netty Pipeline">Netty Pipeline</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-07-21T13:46:37.000Z" title="发表于 2024-07-21 21:46:37">2024-07-21</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Netty/">Netty</a></span></div><div class="content"></div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/#content-inner">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/#content-inner">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/#content-inner">8</a><a class="extend next" rel="next" href="/page/4/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://my-blog-images-1314066800.cos.ap-guangzhou.myqcloud.com/images/dog.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">ZengCP</div><div class="author-info__description">记录心得，见证成长</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">73</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">37</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">31</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/08/%E4%B8%AD%E9%97%B4%E4%BB%B6/RocketMQ/RocketMQ%20%E6%A0%B8%E5%BF%83%E6%9E%B6%E6%9E%84%E5%8E%9F%E7%90%86/" title="RocketMQ 核心架构原理">RocketMQ 核心架构原理</a><time datetime="2024-12-08T09:02:36.000Z" title="发表于 2024-12-08 17:02:36">2024-12-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/08/%E4%B8%AD%E9%97%B4%E4%BB%B6/RocketMQ/RocketMQ%20%E6%A6%82%E8%BF%B0/" title="RocketMQ 概述">RocketMQ 概述</a><time datetime="2024-12-08T07:16:48.000Z" title="发表于 2024-12-08 15:16:48">2024-12-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/Kafka/Kafka%20%E7%BB%8F%E5%85%B8%E9%9D%A2%E8%AF%95%E9%A2%98/" title="Kafka 经典面试题">Kafka 经典面试题</a><time datetime="2024-12-07T12:45:18.000Z" title="发表于 2024-12-07 20:45:18">2024-12-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/Kafka/Kafka%20%E8%BF%9B%E9%98%B6%E7%9F%A5%E8%AF%86/" title="Kafka 进阶">Kafka 进阶</a><time datetime="2024-12-07T08:09:53.000Z" title="发表于 2024-12-07 16:09:53">2024-12-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/06/%E4%B8%AD%E9%97%B4%E4%BB%B6/Kafka/Kafka%20%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93/" title="Kafka 原理总结">Kafka 原理总结</a><time datetime="2024-12-06T11:38:26.000Z" title="发表于 2024-12-06 19:38:26">2024-12-06</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/JVM/"><span class="card-category-list-name">JVM</span><span class="card-category-list-count">3</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/JVM/Java/"><span class="card-category-list-name">Java</span><span class="card-category-list-count">3</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/"><span class="card-category-list-name">Java</span><span class="card-category-list-count">2</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"><span class="card-category-list-name">并发编程</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"><span class="card-category-list-name">操作系统</span><span class="card-category-list-count">1</span></a></li></ul></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/MQ/"><span class="card-category-list-name">MQ</span><span class="card-category-list-count">5</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/MQ/Kafka/"><span class="card-category-list-name">Kafka</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/MQ/RocketMQ/"><span class="card-category-list-name">RocketMQ</span><span class="card-category-list-count">2</span></a></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" style="font-size: 1.37em; color: #99a4b2">分布式</a> <a href="/tags/HTTP/" style="font-size: 1.19em; color: #999da1">HTTP</a> <a href="/tags/MQ/" style="font-size: 1.28em; color: #99a0aa">MQ</a> <a href="/tags/TCP/" style="font-size: 1.14em; color: #999b9d">TCP</a> <a href="/tags/MySQL/" style="font-size: 1.41em; color: #99a5b7">MySQL</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.41em; color: #99a5b7">数据库</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 1.5em; color: #99a9bf">计算机网络</a> <a href="/tags/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/" style="font-size: 1.46em; color: #99a7bb">服务治理</a> <a href="/tags/hdfs/" style="font-size: 1.14em; color: #999b9d">hdfs</a> <a href="/tags/Netty/" style="font-size: 1.32em; color: #99a2ae">Netty</a> <a href="/tags/Kafka/" style="font-size: 1.19em; color: #999da1">Kafka</a> <a href="/tags/%E8%B0%83%E4%BC%98/" style="font-size: 1.1em; color: #999">调优</a> <a href="/tags/hadoop/" style="font-size: 1.23em; color: #999ea6">hadoop</a> <a href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" style="font-size: 1.28em; color: #99a0aa">并发编程</a> <a href="/tags/%E6%9E%B6%E6%9E%84/" style="font-size: 1.14em; color: #999b9d">架构</a> <a href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" style="font-size: 1.23em; color: #999ea6">面试题</a> <a href="/tags/HAProxy/" style="font-size: 1.1em; color: #999">HAProxy</a> <a href="/tags/K8S/" style="font-size: 1.1em; color: #999">K8S</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 1.14em; color: #999b9d">数据结构</a> <a href="/tags/IPC/" style="font-size: 1.19em; color: #999da1">IPC</a> <a href="/tags/UDP/" style="font-size: 1.14em; color: #999b9d">UDP</a> <a href="/tags/JVM/" style="font-size: 1.19em; color: #999da1">JVM</a> <a href="/tags/redis/" style="font-size: 1.28em; color: #99a0aa">redis</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="font-size: 1.1em; color: #999">网络安全</a> <a href="/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" style="font-size: 1.28em; color: #99a0aa">负载均衡</a> <a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 1.28em; color: #99a0aa">操作系统</a> <a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 1.23em; color: #999ea6">大数据</a> <a href="/tags/yarn/" style="font-size: 1.1em; color: #999">yarn</a> <a href="/tags/Linux/" style="font-size: 1.23em; color: #999ea6">Linux</a> <a href="/tags/IO/" style="font-size: 1.14em; color: #999b9d">IO</a> <a href="/tags/InnoDB/" style="font-size: 1.1em; color: #999">InnoDB</a> <a href="/tags/Java/" style="font-size: 1.46em; color: #99a7bb">Java</a> <a href="/tags/DDD/" style="font-size: 1.1em; color: #999">DDD</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 1.19em; color: #999da1">设计模式</a> <a href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/" style="font-size: 1.1em; color: #999">云原生</a> <a href="/tags/RocketMQ/" style="font-size: 1.14em; color: #999b9d">RocketMQ</a> <a href="/tags/%E5%B9%B6%E5%8F%91/" style="font-size: 1.23em; color: #999ea6">并发</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">十一月 2024</span><span class="card-archive-list-count">12</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">十月 2024</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">九月 2024</span><span class="card-archive-list-count">9</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><span class="card-archive-list-count">13</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><span class="card-archive-list-count">9</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><span class="card-archive-list-count">14</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">四月 2024</span><span class="card-archive-list-count">8</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">73</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-02-25T15:37:06.081Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By ZengCP</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>